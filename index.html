<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Striker Pro</title>
    <style>
        body { margin: 0; overflow: hidden; background: #020205; font-family: 'Orbitron', sans-serif; }
        canvas { display: block; }
        #ui {
            position: absolute; top: 20px; left: 20px; color: #00f2ff;
            font-size: 20px; text-shadow: 0 0 10px #00f2ff; pointer-events: none;
        }
        #power-label { color: #00ff88; font-size: 14px; margin-top: 5px; display: none; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

<div id="ui">
    SCORE: <span id="score">0</span>
    <div id="power-label">POWER UP ACTIVE!</div>
</div>
<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const scoreElement = document.getElementById("score");
const powerLabel = document.getElementById("power-label");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let score = 0;
let gameActive = true;
let powerLevel = 1; // Level peluru (1 sampai 3)
let powerTimer = 0;
let shake = 0;

// Posisi Target (Mouse) & Posisi Real (Pesawat)
let targetX = canvas.width / 2;
let targetY = canvas.height - 100;
let playerX = targetX;
let playerY = targetY;

window.addEventListener("pointermove", (e) => {
    targetX = e.clientX;
    targetY = e.clientY;
});

const bullets = [];
const enemies = [];
const particles = [];
const powerUps = [];

class PowerUp {
    constructor(x, y) {
        this.x = x; this.y = y; this.size = 15;
    }
    update() { this.y += 2; }
    draw() {
        ctx.shadowBlur = 15; ctx.shadowColor = "#00ff88";
        ctx.fillStyle = "#00ff88";
        ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI*2); ctx.fill();
    }
}

function spawnEnemy() {
    if (!gameActive) return;
    enemies.push({
        x: Math.random() * (canvas.width - 40),
        y: -50, w: 40, h: 40,
        speed: 3 + (score / 200),
        color: `hsl(${Math.random() * 60 + 300}, 100%, 50%)`
    });
}
setInterval(spawnEnemy, 700);

// Sistem Tembak Berdasarkan Power Level
setInterval(() => {
    if (!gameActive) return;
    if (powerLevel === 1) {
        bullets.push({ x: playerX - 2, y: playerY - 20, vx: 0, vy: -12 });
    } else if (powerLevel === 2) {
        bullets.push({ x: playerX - 10, y: playerY - 20, vx: 0, vy: -12 });
        bullets.push({ x: playerX + 10, y: playerY - 20, vx: 0, vy: -12 });
    } else {
        bullets.push({ x: playerX, y: playerY - 20, vx: 0, vy: -12 });
        bullets.push({ x: playerX - 5, y: playerY - 20, vx: -2, vy: -12 });
        bullets.push({ x: playerX + 5, y: playerY - 20, vx: 2, vy: -12 });
    }
}, 120);

function update() {
    if (!gameActive) return;

    // Smooth Follow (Interpolasi)
    playerX += (targetX - playerX) * 0.15;
    playerY += (targetY - playerY) * 0.15;

    // Power Timer logic
    if (powerTimer > 0) {
        powerTimer--;
        powerLabel.style.display = "block";
    } else {
        powerLevel = 1;
        powerLabel.style.display = "none";
    }

    bullets.forEach((b, i) => {
        b.x += b.vx; b.y += b.vy;
        if (b.y < 0) bullets.splice(i, 1);
    });

    enemies.forEach((en, i) => {
        en.y += en.speed;
        
        // Tabrakan Peluru
        bullets.forEach((b, bi) => {
            if (b.x > en.x && b.x < en.x + en.w && b.y > en.y && b.y < en.y + en.h) {
                shake = 5;
                if (Math.random() > 0.9) powerUps.push(new PowerUp(en.x, en.y));
                enemies.splice(i, 1);
                bullets.splice(bi, 1);
                score += 10;
                scoreElement.innerText = score;
            }
        });

        if (en.y > canvas.height) enemies.splice(i, 1);
        
        // Cek Mati
        let dist = Math.hypot(playerX - (en.x + en.w/2), playerY - (en.y + en.h/2));
        if (dist < 25) gameActive = false;
    });

    powerUps.forEach((p, i) => {
        p.update();
        let dist = Math.hypot(playerX - p.x, playerY - p.y);
        if (dist < 30) {
            powerLevel = 3;
            powerTimer = 500; // Aktif selama ~8 detik
            powerUps.splice(i, 1);
        }
    });

    if (shake > 0) shake *= 0.9;
}

function draw() {
    ctx.save();
    // Efek Screen Shake
    ctx.translate(Math.random() * shake, Math.random() * shake);
    
    ctx.fillStyle = "#020205";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Draw Peluru Neon
    bullets.forEach(b => {
        ctx.shadowBlur = 10; ctx.shadowColor = "#fff";
        ctx.fillStyle = "#fff";
        ctx.fillRect(b.x, b.y, 4, 15);
    });

    // Draw PowerUps
    powerUps.forEach(p => p.draw());

    // Draw Enemies (Hexagon-ish)
    enemies.forEach(en => {
        ctx.shadowBlur = 15; ctx.shadowColor = en.color;
        ctx.fillStyle = en.color;
        ctx.fillRect(en.x, en.y, en.w, en.h);
    });

    // Draw Player (Neon Jet)
    ctx.shadowBlur = 20; ctx.shadowColor = "#00f2ff";
    ctx.fillStyle = "#00f2ff";
    ctx.beginPath();
    ctx.moveTo(playerX, playerY - 25);
    ctx.lineTo(playerX - 15, playerY + 15);
    ctx.lineTo(playerX + 15, playerY + 15);
    ctx.fill();

    ctx.restore();
    update();
    if (gameActive) requestAnimationFrame(draw);
    else {
        ctx.fillStyle = "white"; ctx.textAlign = "center";
        ctx.font = "40px Orbitron";
        ctx.fillText("SYSTEM FAILURE", canvas.width/2, canvas.height/2);
        ctx.font = "20px Orbitron";
        ctx.fillText("Click to Restart", canvas.width/2, canvas.height/2 + 50);
    }
}

canvas.addEventListener("click", () => { if(!gameActive) location.reload(); });
draw();
</script>
</body>
</html>
